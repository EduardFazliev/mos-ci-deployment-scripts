- job:
    name: (9.0)create_param_environment_from_template


    wrappers:
      - build-name:
          name: ${BUILD_NUMBER}.${FILE,path="build-name-setter.info"}
      - ansicolor

    builders:
        - shell: |
            ISO_NAME=`ls "$ISO_DIR"`
            ENV_NAME=MOS_CI_"$ISO_NAME"
            ISO_ID=`echo "$ISO_NAME" | cut -f3 -d-`
            ISO_PATH="${ISO_DIR}/${ISO_NAME}"

            echo "ENV_NAME=$ENV_NAME" > "$ENV_INJECT_PATH"
            echo "ISO_ID=$ISO_ID" >> "$ENV_INJECT_PATH"
            echo "ISO_PATH=$ISO_PATH" >> "$ENV_INJECT_PATH"

        - inject:
            properties-file: "$ENV_INJECT_PATH"

        - shell:
            !include-raw: ../shell_scripts/deploy_env_from_template.sh

    project-type: freestyle
    defaults: global
    scm:
       - 9.0-mos-ci-deployment-scripts
    description: 'Create environment with parameters, specified by PARAM string.'
    disabled: false
    display-name: '(9.0)Create Parameterized Environment From Template'
    concurrent: true
    browser: githubweb
    retry-count: 3
    logrotate:
      daysToKeep: 20
      numToKeep: 200
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    publishers:
      - workspace-cleanup:
          fail-build: false
      - email:
          recipients: efazliev@mirantis.com
